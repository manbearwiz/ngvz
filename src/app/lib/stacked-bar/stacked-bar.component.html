<svg [attr.width]="width" [attr.height]="height" *ngIf="stack">
  <g ngvzTransform [translateX]="margin.left" [translateY]="margin.top">
    <g *ngFor="let s of stack">
      <g *ngFor="let t of s">
        <rect [attr.x]="x(t.data.State)" [attr.y]="y(t[1])" [attr.height]="y(t[0]) - y(t[1])" [attr.width]="x.bandwidth()" [ngvzFillOrdinal]="s.key"
          [colors]="colors"></rect>
      </g>
    </g>

    <g ngvz-axis ngvzTransform [translateY]="innerHeight" class="x axis" [scale]="x" position="bottom" [tickOffset]="x.bandwidth() / 2"></g>
    
    <text x="2" y="0.5" dy="0.32em" fill="#000" font-weight="bold" text-anchor="start">Population</text>
    <g ngvz-axis class="y axis" [scale]="y" position="left">
      <ng-container *ngvzTick="let name">{{name / 1000000}}M</ng-container>
    </g>

    <g text-anchor="end">
      <g *ngFor="let s of stack; index as i;" ngvzTransform [translateY]="i * 20">
        <rect x="881" width="19" height="19" [ngvzFillOrdinal]="s.key" [colors]="colors.slice().reverse()"></rect>
        <text x="876" y="9.5" dy="0.32em">{{s.key}}</text>
      </g>
    </g>
  </g>
</svg>
